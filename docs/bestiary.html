<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.4 A ggplot bestiary | An Introduction to R</title>
  <meta name="description" content="A practical introduction to using R for data analysis" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="5.4 A ggplot bestiary | An Introduction to R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://alexd106.github.io/Rbook//images/cover_v3.png" />
  <meta property="og:description" content="A practical introduction to using R for data analysis" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.4 A ggplot bestiary | An Introduction to R" />
  
  <meta name="twitter:description" content="A practical introduction to using R for data analysis" />
  <meta name="twitter:image" content="https://alexd106.github.io/Rbook//images/cover_v3.png" />

<meta name="author" content="Alex Douglas, Deon Roos, Francesca Mancini, Ana Couto &amp; David Lusseau" />


<meta name="date" content="2024-02-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tips.html"/>
<link rel="next" href="exercise-5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162377463-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162377463-3');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="the-aim-of-this-book.html"><a href="the-aim-of-this-book.html"><i class="fa fa-check"></i><b>0.1</b> The aim of this book</a></li>
<li class="chapter" data-level="0.2" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i><b>0.2</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.3" data-path="why-an-open-book.html"><a href="why-an-open-book.html"><i class="fa fa-check"></i><b>0.3</b> Why an open book?</a></li>
<li class="chapter" data-level="0.4" data-path="whoarewe.html"><a href="whoarewe.html"><i class="fa fa-check"></i><b>0.4</b> Who are we?</a></li>
<li class="chapter" data-level="0.5" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>0.5</b> How to use this book</a></li>
<li class="chapter" data-level="0.6" data-path="book-website.html"><a href="book-website.html"><i class="fa fa-check"></i><b>0.6</b> Book website</a></li>
<li class="chapter" data-level="0.7" data-path="some-r-pointers.html"><a href="some-r-pointers.html"><i class="fa fa-check"></i><b>0.7</b> Some R pointers</a></li>
<li class="chapter" data-level="0.8" data-path="thanks.html"><a href="thanks.html"><i class="fa fa-check"></i><b>0.8</b> Thanks</a></li>
<li class="chapter" data-level="0.9" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>0.9</b> License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="install_r.html"><a href="install_r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="install_r.html"><a href="install_r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install_r.html"><a href="install_r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install_r.html"><a href="install_r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install_r.html"><a href="install_r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio_orient.html"><a href="rstudio_orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio_orient.html"><a href="rstudio_orient.html#cons"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio_orient.html"><a href="rstudio_orient.html#environmenthistoryconnections"><i class="fa fa-check"></i><b>1.3.2</b> Environment/History/Connections</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio_orient.html"><a href="rstudio_orient.html#filesplotspackageshelpviewer"><i class="fa fa-check"></i><b>1.3.3</b> Files/Plots/Packages/Help/Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html#advanced-text-editors"><i class="fa fa-check"></i><b>1.4.1</b> Advanced text editors</a></li>
<li class="chapter" data-level="1.4.2" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html#integrated-developement-environements"><i class="fa fa-check"></i><b>1.4.2</b> Integrated developement environements</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="packages.html"><a href="packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="packages.html"><a href="packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="packages.html"><a href="packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="packages.html"><a href="packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rsprojs.html"><a href="rsprojs.html"><i class="fa fa-check"></i><b>1.6</b> Projects in RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="work-d.html"><a href="work-d.html"><i class="fa fa-check"></i><b>1.7</b> Working directories</a></li>
<li class="chapter" data-level="1.8" data-path="dir_struct.html"><a href="dir_struct.html"><i class="fa fa-check"></i><b>1.8</b> Directory structure</a></li>
<li class="chapter" data-level="1.9" data-path="file_names.html"><a href="file_names.html"><i class="fa fa-check"></i><b>1.9</b> File names</a></li>
<li class="chapter" data-level="1.10" data-path="proj_doc.html"><a href="proj_doc.html"><i class="fa fa-check"></i><b>1.10</b> Project documentation</a></li>
<li class="chapter" data-level="1.11" data-path="r-style-guide.html"><a href="r-style-guide.html"><i class="fa fa-check"></i><b>1.11</b> R style guide</a></li>
<li class="chapter" data-level="1.12" data-path="backing-up-projects.html"><a href="backing-up-projects.html"><i class="fa fa-check"></i><b>1.12</b> Backing up projects</a></li>
<li class="chapter" data-level="1.13" data-path="citing-r.html"><a href="citing-r.html"><i class="fa fa-check"></i><b>1.13</b> Citing R</a></li>
<li class="chapter" data-level="1.14" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>1.14</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics_r.html"><a href="basics_r.html"><i class="fa fa-check"></i><b>2</b> Some R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="objects-in-r.html"><a href="objects-in-r.html"><i class="fa fa-check"></i><b>2.2</b> Objects in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="objects-in-r.html"><a href="objects-in-r.html#r_objs"><i class="fa fa-check"></i><b>2.2.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="objects-in-r.html"><a href="objects-in-r.html#naming-objects"><i class="fa fa-check"></i><b>2.2.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="using-functions-in-r.html"><a href="using-functions-in-r.html"><i class="fa fa-check"></i><b>2.3</b> Using functions in R</a></li>
<li class="chapter" data-level="2.4" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="vectors.html"><a href="vectors.html#extracting-elements"><i class="fa fa-check"></i><b>2.4.1</b> Extracting elements</a></li>
<li class="chapter" data-level="2.4.2" data-path="vectors.html"><a href="vectors.html#replacing-elements"><i class="fa fa-check"></i><b>2.4.2</b> Replacing elements</a></li>
<li class="chapter" data-level="2.4.3" data-path="vectors.html"><a href="vectors.html#vec_ord"><i class="fa fa-check"></i><b>2.4.3</b> Ordering elements</a></li>
<li class="chapter" data-level="2.4.4" data-path="vectors.html"><a href="vectors.html#vectorisation"><i class="fa fa-check"></i><b>2.4.4</b> Vectorisation</a></li>
<li class="chapter" data-level="2.4.5" data-path="vectors.html"><a href="vectors.html#na_vals"><i class="fa fa-check"></i><b>2.4.5</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>2.5</b> Getting help</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="help.html"><a href="help.html#r-help"><i class="fa fa-check"></i><b>2.5.1</b> R help</a></li>
<li class="chapter" data-level="2.5.2" data-path="help.html"><a href="help.html#rhelp"><i class="fa fa-check"></i><b>2.5.2</b> Other sources of help</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="saving-stuff-in-r.html"><a href="saving-stuff-in-r.html"><i class="fa fa-check"></i><b>2.6</b> Saving stuff in R</a></li>
<li class="chapter" data-level="2.7" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>2.7</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data_r.html"><a href="data_r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3.1</b> Data types</a></li>
<li class="chapter" data-level="3.2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-structures.html"><a href="data-structures.html#scal_vecs"><i class="fa fa-check"></i><b>3.2.1</b> Scalars and vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-structures.html"><a href="data-structures.html#mat_array"><i class="fa fa-check"></i><b>3.2.2</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.2.3</b> Lists</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-structures.html"><a href="data-structures.html#df"><i class="fa fa-check"></i><b>3.2.4</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="importing-data.html"><a href="importing-data.html#saving-files-to-import"><i class="fa fa-check"></i><b>3.3.1</b> Saving files to import</a></li>
<li class="chapter" data-level="3.3.2" data-path="importing-data.html"><a href="importing-data.html#import_fnc"><i class="fa fa-check"></i><b>3.3.2</b> Import functions</a></li>
<li class="chapter" data-level="3.3.3" data-path="importing-data.html"><a href="importing-data.html#common-import-frustrations"><i class="fa fa-check"></i><b>3.3.3</b> Common import frustrations</a></li>
<li class="chapter" data-level="3.3.4" data-path="importing-data.html"><a href="importing-data.html#import_other"><i class="fa fa-check"></i><b>3.3.4</b> Other import options</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html"><i class="fa fa-check"></i><b>3.4</b> Wrangling data frames</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#positional-indexes"><i class="fa fa-check"></i><b>3.4.1</b> Positional indexes</a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#logical-indexes"><i class="fa fa-check"></i><b>3.4.2</b> Logical indexes</a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#ordering-data-frames"><i class="fa fa-check"></i><b>3.4.3</b> Ordering data frames</a></li>
<li class="chapter" data-level="3.4.4" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#adding-columns-and-rows"><i class="fa fa-check"></i><b>3.4.4</b> Adding columns and rows</a></li>
<li class="chapter" data-level="3.4.5" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#merging-data-frames"><i class="fa fa-check"></i><b>3.4.5</b> Merging data frames</a></li>
<li class="chapter" data-level="3.4.6" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#reshape"><i class="fa fa-check"></i><b>3.4.6</b> Reshaping data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="summarising-data-frames.html"><a href="summarising-data-frames.html"><i class="fa fa-check"></i><b>3.5</b> Summarising data frames</a></li>
<li class="chapter" data-level="3.6" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>3.6</b> Exporting data</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="exporting-data.html"><a href="exporting-data.html#export-functions"><i class="fa fa-check"></i><b>3.6.1</b> Export functions</a></li>
<li class="chapter" data-level="3.6.2" data-path="exporting-data.html"><a href="exporting-data.html#other-export-functions"><i class="fa fa-check"></i><b>3.6.2</b> Other export functions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>3.7</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphics_base_r.html"><a href="graphics_base_r.html"><i class="fa fa-check"></i><b>4</b> Graphics with base R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="baseplot_start.html"><a href="baseplot_start.html"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html"><i class="fa fa-check"></i><b>4.2</b> Simple base R plots</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#scatterplot"><i class="fa fa-check"></i><b>4.2.1</b> Scatterplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#box-and-violin-plots"><i class="fa fa-check"></i><b>4.2.3</b> Box and violin plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#dotcharts"><i class="fa fa-check"></i><b>4.2.4</b> Dot charts</a></li>
<li class="chapter" data-level="4.2.5" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#pairs-plots"><i class="fa fa-check"></i><b>4.2.5</b> Pairs plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#coplots"><i class="fa fa-check"></i><b>4.2.6</b> Coplots</a></li>
<li class="chapter" data-level="4.2.7" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#lattice-plots"><i class="fa fa-check"></i><b>4.2.7</b> Lattice plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="custom_plot.html"><a href="custom_plot.html"><i class="fa fa-check"></i><b>4.3</b> Customising plots</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="custom_plot.html"><a href="custom_plot.html#customising-with-arguments"><i class="fa fa-check"></i><b>4.3.1</b> Customising with arguments</a></li>
<li class="chapter" data-level="4.3.2" data-path="custom_plot.html"><a href="custom_plot.html#building-plots"><i class="fa fa-check"></i><b>4.3.2</b> Building plots</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="mult_graphs.html"><a href="mult_graphs.html"><i class="fa fa-check"></i><b>4.4</b> Multiple graphs</a></li>
<li class="chapter" data-level="4.5" data-path="export_plots.html"><a href="export_plots.html"><i class="fa fa-check"></i><b>4.5</b> Exporting plots</a></li>
<li class="chapter" data-level="4.6" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>4.6</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics_r.html"><a href="graphics_r.html"><i class="fa fa-check"></i><b>5</b> Graphics with ggplot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>5.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="5.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>5.2</b> The start of the end</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>5.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>5.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>5.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>5.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>5.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>5.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>5.3</b> Tips and tricks</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="tips.html"><a href="tips.html#statistics-layer"><i class="fa fa-check"></i><b>5.3.1</b> Statistics layer</a></li>
<li class="chapter" data-level="5.3.2" data-path="tips.html"><a href="tips.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>5.3.2</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="5.3.3" data-path="tips.html"><a href="tips.html#layering-layers"><i class="fa fa-check"></i><b>5.3.3</b> Layering layers</a></li>
<li class="chapter" data-level="5.3.4" data-path="tips.html"><a href="tips.html#continuous-colours"><i class="fa fa-check"></i><b>5.3.4</b> Continuous colours</a></li>
<li class="chapter" data-level="5.3.5" data-path="tips.html"><a href="tips.html#size-of-points"><i class="fa fa-check"></i><b>5.3.5</b> Size of points</a></li>
<li class="chapter" data-level="5.3.6" data-path="tips.html"><a href="tips.html#moving-the-legend"><i class="fa fa-check"></i><b>5.3.6</b> Moving the legend</a></li>
<li class="chapter" data-level="5.3.7" data-path="tips.html"><a href="tips.html#hiding-the-legend"><i class="fa fa-check"></i><b>5.3.7</b> Hiding the legend</a></li>
<li class="chapter" data-level="5.3.8" data-path="tips.html"><a href="tips.html#hiding-part-of-the-legend"><i class="fa fa-check"></i><b>5.3.8</b> Hiding part of the legend</a></li>
<li class="chapter" data-level="5.3.9" data-path="tips.html"><a href="tips.html#writing-on-a-figure"><i class="fa fa-check"></i><b>5.3.9</b> Writing on a figure</a></li>
<li class="chapter" data-level="5.3.10" data-path="tips.html"><a href="tips.html#axes-tick-marks-and-tick-labels"><i class="fa fa-check"></i><b>5.3.10</b> Axes tick marks and tick labels</a></li>
<li class="chapter" data-level="5.3.11" data-path="tips.html"><a href="tips.html#more-advanced-patchwork"><i class="fa fa-check"></i><b>5.3.11</b> More advanced patchwork</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bestiary.html"><a href="bestiary.html"><i class="fa fa-check"></i><b>5.4</b> A ggplot bestiary</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bestiary.html"><a href="bestiary.html#density-plot"><i class="fa fa-check"></i><b>5.4.1</b> Density plot</a></li>
<li class="chapter" data-level="5.4.2" data-path="bestiary.html"><a href="bestiary.html#histogram"><i class="fa fa-check"></i><b>5.4.2</b> Histogram</a></li>
<li class="chapter" data-level="5.4.3" data-path="bestiary.html"><a href="bestiary.html#frequency-polygons"><i class="fa fa-check"></i><b>5.4.3</b> Frequency polygons</a></li>
<li class="chapter" data-level="5.4.4" data-path="bestiary.html"><a href="bestiary.html#boxplot"><i class="fa fa-check"></i><b>5.4.4</b> Boxplot</a></li>
<li class="chapter" data-level="5.4.5" data-path="bestiary.html"><a href="bestiary.html#violin-plots"><i class="fa fa-check"></i><b>5.4.5</b> Violin plots</a></li>
<li class="chapter" data-level="5.4.6" data-path="bestiary.html"><a href="bestiary.html#barchart"><i class="fa fa-check"></i><b>5.4.6</b> Barchart</a></li>
<li class="chapter" data-level="5.4.7" data-path="bestiary.html"><a href="bestiary.html#quantile-lines"><i class="fa fa-check"></i><b>5.4.7</b> Quantile lines</a></li>
<li class="chapter" data-level="5.4.8" data-path="bestiary.html"><a href="bestiary.html#heatmap"><i class="fa fa-check"></i><b>5.4.8</b> Heatmap</a></li>
<li class="chapter" data-level="5.4.9" data-path="bestiary.html"><a href="bestiary.html#hex-map"><i class="fa fa-check"></i><b>5.4.9</b> Hex map</a></li>
<li class="chapter" data-level="5.4.10" data-path="bestiary.html"><a href="bestiary.html#contour-map"><i class="fa fa-check"></i><b>5.4.10</b> Contour map</a></li>
<li class="chapter" data-level="5.4.11" data-path="bestiary.html"><a href="bestiary.html#cleveland-dotplot"><i class="fa fa-check"></i><b>5.4.11</b> Cleveland dotplot</a></li>
<li class="chapter" data-level="5.4.12" data-path="bestiary.html"><a href="bestiary.html#pairs-plot"><i class="fa fa-check"></i><b>5.4.12</b> Pairs plot</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i><b>5.5</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stats_r.html"><a href="stats_r.html"><i class="fa fa-check"></i><b>6</b> Simple Statistics in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="one-and-two-sample-tests.html"><a href="one-and-two-sample-tests.html"><i class="fa fa-check"></i><b>6.1</b> One and two sample tests</a></li>
<li class="chapter" data-level="6.2" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>6.2</b> Correlation</a></li>
<li class="chapter" data-level="6.3" data-path="simple_lm.html"><a href="simple_lm.html"><i class="fa fa-check"></i><b>6.3</b> Simple linear modelling</a></li>
<li class="chapter" data-level="6.4" data-path="other-modelling-approaches.html"><a href="other-modelling-approaches.html"><i class="fa fa-check"></i><b>6.4</b> Other modelling approaches</a></li>
<li class="chapter" data-level="6.5" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i><b>6.5</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prog_r.html"><a href="prog_r.html"><i class="fa fa-check"></i><b>7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="looking-behind-the-curtain.html"><a href="looking-behind-the-curtain.html"><i class="fa fa-check"></i><b>7.1</b> Looking behind the curtain</a></li>
<li class="chapter" data-level="7.2" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>7.2</b> Functions in R</a></li>
<li class="chapter" data-level="7.3" data-path="conditional-statements.html"><a href="conditional-statements.html"><i class="fa fa-check"></i><b>7.3</b> Conditional statements</a></li>
<li class="chapter" data-level="7.4" data-path="combining-logical-operators.html"><a href="combining-logical-operators.html"><i class="fa fa-check"></i><b>7.4</b> Combining logical operators</a></li>
<li class="chapter" data-level="7.5" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>7.5</b> Loops</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="loops.html"><a href="loops.html#for-loop"><i class="fa fa-check"></i><b>7.5.1</b> For loop</a></li>
<li class="chapter" data-level="7.5.2" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i><b>7.5.2</b> While loop</a></li>
<li class="chapter" data-level="7.5.3" data-path="loops.html"><a href="loops.html#when-to-use-a-loop"><i class="fa fa-check"></i><b>7.5.3</b> When to use a loop?</a></li>
<li class="chapter" data-level="7.5.4" data-path="loops.html"><a href="loops.html#if-not-loops-then-what"><i class="fa fa-check"></i><b>7.5.4</b> If not loops, then what?</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="exercise-7.html"><a href="exercise-7.html"><i class="fa fa-check"></i><b>7.6</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rmarkdown_r.html"><a href="rmarkdown_r.html"><i class="fa fa-check"></i><b>8</b> Reproducible reports with R markdown</a>
<ul>
<li class="chapter" data-level="8.1" data-path="what-is-r-markdown.html"><a href="what-is-r-markdown.html"><i class="fa fa-check"></i><b>8.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="8.2" data-path="why-use-r-markdown.html"><a href="why-use-r-markdown.html"><i class="fa fa-check"></i><b>8.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="8.3" data-path="get-started-with-r-markdown.html"><a href="get-started-with-r-markdown.html"><i class="fa fa-check"></i><b>8.3</b> Get started with R markdown</a></li>
<li class="chapter" data-level="8.4" data-path="new_rm.html"><a href="new_rm.html"><i class="fa fa-check"></i><b>8.4</b> Create an R markdown document</a></li>
<li class="chapter" data-level="8.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html"><i class="fa fa-check"></i><b>8.5</b> R markdown anatomy</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#yaml-header"><i class="fa fa-check"></i><b>8.5.1</b> YAML header</a></li>
<li class="chapter" data-level="8.5.2" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#formatted-text"><i class="fa fa-check"></i><b>8.5.2</b> Formatted text</a></li>
<li class="chapter" data-level="8.5.3" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#code_chunks"><i class="fa fa-check"></i><b>8.5.3</b> Code chunks</a></li>
<li class="chapter" data-level="8.5.4" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-figures"><i class="fa fa-check"></i><b>8.5.4</b> Adding figures</a></li>
<li class="chapter" data-level="8.5.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-tables"><i class="fa fa-check"></i><b>8.5.5</b> Adding tables</a></li>
<li class="chapter" data-level="8.5.6" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#inline-r-code"><i class="fa fa-check"></i><b>8.5.6</b> Inline R code</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="tips_tricks.html"><a href="tips_tricks.html"><i class="fa fa-check"></i><b>8.6</b> Some tips and tricks</a></li>
<li class="chapter" data-level="8.7" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>8.7</b> Further Information</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="github_r.html"><a href="github_r.html"><i class="fa fa-check"></i><b>9</b> Version control with Git and GitHub</a>
<ul>
<li class="chapter" data-level="9.1" data-path="what-is-version-control.html"><a href="what-is-version-control.html"><i class="fa fa-check"></i><b>9.1</b> What is version control?</a></li>
<li class="chapter" data-level="9.2" data-path="why-use-version-control.html"><a href="why-use-version-control.html"><i class="fa fa-check"></i><b>9.2</b> Why use version control?</a></li>
<li class="chapter" data-level="9.3" data-path="what-is-git-and-github.html"><a href="what-is-git-and-github.html"><i class="fa fa-check"></i><b>9.3</b> What is Git and GitHub?</a></li>
<li class="chapter" data-level="9.4" data-path="setup_git.html"><a href="setup_git.html"><i class="fa fa-check"></i><b>9.4</b> Getting started</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="setup_git.html"><a href="setup_git.html#install-git"><i class="fa fa-check"></i><b>9.4.1</b> Install Git</a></li>
<li class="chapter" data-level="9.4.2" data-path="setup_git.html"><a href="setup_git.html#configure-git"><i class="fa fa-check"></i><b>9.4.2</b> Configure Git</a></li>
<li class="chapter" data-level="9.4.3" data-path="setup_git.html"><a href="setup_git.html#rs_config"><i class="fa fa-check"></i><b>9.4.3</b> Configure RStudio</a></li>
<li class="chapter" data-level="9.4.4" data-path="setup_git.html"><a href="setup_git.html#register-a-github-account"><i class="fa fa-check"></i><b>9.4.4</b> Register a GitHub account</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html"><i class="fa fa-check"></i><b>9.5</b> Setting up a project in RStudio</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt1"><i class="fa fa-check"></i><b>9.5.1</b> Option 1 - GitHub first</a></li>
<li class="chapter" data-level="9.5.2" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt2"><i class="fa fa-check"></i><b>9.5.2</b> Option 2 - RStudio first</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="use_git.html"><a href="use_git.html"><i class="fa fa-check"></i><b>9.6</b> Using Git</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="use_git.html"><a href="use_git.html#tracking-changes"><i class="fa fa-check"></i><b>9.6.1</b> Tracking changes</a></li>
<li class="chapter" data-level="9.6.2" data-path="use_git.html"><a href="use_git.html#commit-history"><i class="fa fa-check"></i><b>9.6.2</b> Commit history</a></li>
<li class="chapter" data-level="9.6.3" data-path="use_git.html"><a href="use_git.html#undo"><i class="fa fa-check"></i><b>9.6.3</b> Reverting changes</a></li>
<li class="chapter" data-level="9.6.4" data-path="use_git.html"><a href="use_git.html#collab"><i class="fa fa-check"></i><b>9.6.4</b> Collaborate with Git</a></li>
<li class="chapter" data-level="9.6.5" data-path="use_git.html"><a href="use_git.html#git-tips"><i class="fa fa-check"></i><b>9.6.5</b> Git tips</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>9.7</b> Further resources</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="install-rm.html"><a href="install-rm.html"><i class="fa fa-check"></i><b>A</b> Installing R Markdown</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ms-windows.html"><a href="ms-windows.html"><i class="fa fa-check"></i><b>A.1</b> MS Windows</a></li>
<li class="chapter" data-level="A.2" data-path="mac-osx.html"><a href="mac-osx.html"><i class="fa fa-check"></i><b>A.2</b> Mac OSX</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bestiary" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> A ggplot bestiary<a href="bestiary.html#bestiary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What follows is a quick run through of example <code>ggplots</code>. These will predominantly be created by changing the geoms used, but there will be additional tweaks which we’ll highlight.</p>
<div id="density-plot" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Density plot<a href="bestiary.html#density-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below is a density plot which is much like a histogram. The x axis shows observations of given numbers of flowers, while the y axis is the density of observations (roughly equivalent to number of rows with that many flowers, calculated in the background by the statistics layer). Each density is coloured according to nitrogen concentration, though note that we’re using <code>fill =</code> instead of <code>colour =</code>. Try using colour instead to see what happens.</p>
<p>Notice that we haven’t used <code>data = flower</code> here and instead just used <code>flower</code>? When an object is not assigned with an argument, <code>ggplot2</code> will assume that it is the dataset. We’re using that here, but we actually prefer to explicitly state the argument name in our own work.</p>
<p> </p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="bestiary.html#cb310-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb310-2"><a href="bestiary.html#cb310-2" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> flowers, <span class="at">fill =</span> nitrogen), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb310-3"><a href="bestiary.html#cb310-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Nitrogen</span><span class="sc">\n</span><span class="st">Concentration&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-4"><a href="bestiary.html#cb310-4" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</span>
<span id="cb310-5"><a href="bestiary.html#cb310-5" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#DB24BC&quot;</span>, <span class="st">&quot;#BCDB24&quot;</span>, <span class="st">&quot;#24BCDB&quot;</span>)) <span class="sc">+</span></span>
<span id="cb310-6"><a href="bestiary.html#cb310-6" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/density-plot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="histogram" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Histogram<a href="bestiary.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next is a histogram (a much more traditional version of a density plot). There are a couple of things to take note of here. The first is that <code>flower$block</code> is numeric and not a factor. We can correct that here fairly easily using the <code>factor()</code> function to convert it from numeric to factor (though ideally we’d have done this before - see <a href="data_r.html#data_r">Chapter 3</a>). The other thing to take note of is that we’ve specified <code>bins = 20</code>. The number of bins control how many times the y-axis is broken up to show the data. Try increasing and decreasing to see the effect. The last is using the <code>position =</code> argument and stating that we do not want the bars to be stacked (the default position), instead we want them side-by-side, a.k.a. dodged.</p>
<p> </p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="bestiary.html#cb311-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb311-2"><a href="bestiary.html#cb311-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> flowers, <span class="at">fill =</span> <span class="fu">factor</span>(block)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb311-3"><a href="bestiary.html#cb311-3" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb311-4"><a href="bestiary.html#cb311-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Greenhouse</span><span class="sc">\n</span><span class="st">Block&quot;</span>) <span class="sc">+</span></span>
<span id="cb311-5"><a href="bestiary.html#cb311-5" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>),</span>
<span id="cb311-6"><a href="bestiary.html#cb311-6" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#8CD926&quot;</span>, <span class="st">&quot;#7326D9&quot;</span>)) <span class="sc">+</span></span>
<span id="cb311-7"><a href="bestiary.html#cb311-7" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/histogram-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="frequency-polygons" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Frequency polygons<a href="bestiary.html#frequency-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A frequency polygon is yet another visualisation of the above two. The only difference here is that we are drawing a line to each value, instead of a density curve or bars.</p>
<p> </p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="bestiary.html#cb312-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb312-2"><a href="bestiary.html#cb312-2" tabindex="-1"></a>    <span class="fu">geom_freqpoly</span>(<span class="fu">aes</span>(<span class="at">x =</span> flowers, <span class="at">colour =</span> <span class="fu">factor</span>(block)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb312-3"><a href="bestiary.html#cb312-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;Greenhouse</span><span class="sc">\n</span><span class="st">Block&quot;</span>) <span class="sc">+</span></span>
<span id="cb312-4"><a href="bestiary.html#cb312-4" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>),</span>
<span id="cb312-5"><a href="bestiary.html#cb312-5" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#8CD926&quot;</span>, <span class="st">&quot;#7326D9&quot;</span>)) <span class="sc">+</span></span>
<span id="cb312-6"><a href="bestiary.html#cb312-6" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/freqpoly-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="boxplot" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Boxplot<a href="bestiary.html#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Boxplots are a classic way to show to spread of data, and they’re easy to make in <code>ggplot2</code>. The dark line in the middle of the box shows the median, the boxes show the 25th and 75th percentiles (which is different from the base R <code>boxplot()</code>), and the whiskers show 1.5 times the inter-quartile range (i.e. the distance between between the lower and upper quartiles).</p>
<p> </p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="bestiary.html#cb313-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb313-2"><a href="bestiary.html#cb313-2" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> flowers, <span class="at">x =</span> nitrogen)) <span class="sc">+</span></span>
<span id="cb313-3"><a href="bestiary.html#cb313-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>) <span class="sc">+</span></span>
<span id="cb313-4"><a href="bestiary.html#cb313-4" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/boxplot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plots" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Violin plots<a href="bestiary.html#violin-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Violin plots are an increasingly popular alternative to boxplots. They display much of the same information, as well as showing a version of the density plot above (imagine each violin plot, cut in half vertically and place on it’s side, thus showing the overall distribution of the data). In the plot below the figure is slightly more complex than those above and so deserves some explanation.</p>
<p>Within <code>geom_violin()</code> we’ve included <code>draw_quantiles =</code> where we’ve specified we want quantile lines drawn at the 25, 50 and 75 quantiles (using the <code>c()</code> function). In combination with <code>geom_violin()</code> we’ve also included <code>geom_jitter()</code>. <code>geom_jitter()</code> is similar to <code>geom_point()</code> but induces a slight random spread of the points, often helpful when those points would otherwise be clustered. Within <code>geom_jitter()</code> we’ve also set <code>height = 0</code>, and <code>width = 0.1</code> which specifies how much to jitter the points in a given dimension (here essentially telling <code>ggplot2</code> not to jitter by height, and only to jitter width by a small amount).</p>
<p>Finally, we’re also using this plot to show <code>scale_y_log10</code>. Hopefully this is largely self-explanatory (it converts the y-axis to the <span class="math inline">\(\text{log}_{10}\)</span> scale). There are additional scaling options for axis (for instance <code>scale_y_sqrt()</code>). Please note that using a log scaled axis in this case is actually doing harm in terms of understanding the data, we’d actually be much better off not doing so in this particular case.</p>
<p> </p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="bestiary.html#cb314-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb314-2"><a href="bestiary.html#cb314-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">y =</span> flowers, <span class="at">x =</span> nitrogen, <span class="at">fill =</span> nitrogen), </span>
<span id="cb314-3"><a href="bestiary.html#cb314-3" tabindex="-1"></a>              <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb314-4"><a href="bestiary.html#cb314-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y =</span> flowers, <span class="at">x =</span> nitrogen), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">height =</span> <span class="dv">0</span>, </span>
<span id="cb314-5"><a href="bestiary.html#cb314-5" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb314-6"><a href="bestiary.html#cb314-6" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</span>
<span id="cb314-7"><a href="bestiary.html#cb314-7" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#5f7f5c&quot;</span>, <span class="st">&quot;#749770&quot;</span>, <span class="st">&quot;#9eb69b&quot;</span>)) <span class="sc">+</span></span>
<span id="cb314-8"><a href="bestiary.html#cb314-8" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>) <span class="sc">+</span></span>
<span id="cb314-9"><a href="bestiary.html#cb314-9" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb314-10"><a href="bestiary.html#cb314-10" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/violin-plot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="barchart" class="section level3 hasAnchor" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> Barchart<a href="bestiary.html#barchart" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below is an example of barcharts. It is included here for completeness, but be aware that they are viewed with contention (with good reason). Briefly, barcharts can hide information, or imply there is data where there is none; ultimately misleading the reader. There are almost always better alternatives to use that better demonstrate the data.</p>
<p> </p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bestiary.html#cb315-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span></span>
<span id="cb315-2"><a href="bestiary.html#cb315-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(block), <span class="at">fill =</span> nitrogen)) <span class="sc">+</span></span>
<span id="cb315-3"><a href="bestiary.html#cb315-3" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</span>
<span id="cb315-4"><a href="bestiary.html#cb315-4" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#2613EC&quot;</span>, <span class="st">&quot;#9313EC&quot;</span>, <span class="st">&quot;#EC13D9&quot;</span>)) <span class="sc">+</span></span>
<span id="cb315-5"><a href="bestiary.html#cb315-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Block&quot;</span>) <span class="sc">+</span></span>
<span id="cb315-6"><a href="bestiary.html#cb315-6" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/barchart-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>The barchart shows the numbers of observations in each block, with each bar split according to the number of observations in each nitrogen concentration. In this case they are equal because the dataset (and experimental design) was balanced.</p>
</div>
<div id="quantile-lines" class="section level3 hasAnchor" number="5.4.7">
<h3><span class="header-section-number">5.4.7</span> Quantile lines<a href="bestiary.html#quantile-lines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While we can draw a straight line, perhaps we would also like to include the descriptive nature of a boxplot, except using continuous data. We can use quantile lines in such cases. Note that for quantiles to be calculated <code>ggplot2</code> requires the installation of the package <code>quantreg</code>.</p>
<p> </p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="bestiary.html#cb316-1" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb316-2"><a href="bestiary.html#cb316-2" tabindex="-1"></a></span>
<span id="cb316-3"><a href="bestiary.html#cb316-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> shootarea), <span class="at">data =</span> flower) <span class="sc">+</span></span>
<span id="cb316-4"><a href="bestiary.html#cb316-4" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb316-5"><a href="bestiary.html#cb316-5" tabindex="-1"></a>    <span class="fu">geom_quantile</span>(<span class="at">colour =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb316-6"><a href="bestiary.html#cb316-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-7"><a href="bestiary.html#cb316-7" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/quantile-lines-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="heatmap" class="section level3 hasAnchor" number="5.4.8">
<h3><span class="header-section-number">5.4.8</span> Heatmap<a href="bestiary.html#heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmaps are a great tool to visualise spatial patterns. <code>ggplot2</code> can easily handle such data using <code>geom_bin2d()</code> to allow us to see if our data is more (or less) clustered.</p>
<p> </p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="bestiary.html#cb317-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> leafarea, <span class="at">y =</span> shootarea), <span class="at">data =</span> flower) <span class="sc">+</span></span>
<span id="cb317-2"><a href="bestiary.html#cb317-2" tabindex="-1"></a>    <span class="fu">geom_bin2d</span>() <span class="sc">+</span></span>
<span id="cb317-3"><a href="bestiary.html#cb317-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="sc">+</span></span>
<span id="cb317-4"><a href="bestiary.html#cb317-4" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb317-5"><a href="bestiary.html#cb317-5" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/heat-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>In this example, lighter blue squares show combinations of leaf area and shoot area where we have more data, and dark blue shows the converse.</p>
</div>
<div id="hex-map" class="section level3 hasAnchor" number="5.4.9">
<h3><span class="header-section-number">5.4.9</span> Hex map<a href="bestiary.html#hex-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A similar version to <code>geom_density2d()</code> is <code>geom_hex()</code>. The only difference between the two is that the squares are replaced with hexagons. Note that <code>geom_hex()</code> requires you to first install an additional package called <code>hexbin</code>.</p>
<p> </p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="bestiary.html#cb318-1" tabindex="-1"></a><span class="fu">library</span>(hexbin)</span>
<span id="cb318-2"><a href="bestiary.html#cb318-2" tabindex="-1"></a></span>
<span id="cb318-3"><a href="bestiary.html#cb318-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> leafarea, <span class="at">y =</span> shootarea), <span class="at">data =</span> flower) <span class="sc">+</span></span>
<span id="cb318-4"><a href="bestiary.html#cb318-4" tabindex="-1"></a>    <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb318-5"><a href="bestiary.html#cb318-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-6"><a href="bestiary.html#cb318-6" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb318-7"><a href="bestiary.html#cb318-7" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/hex-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="contour-map" class="section level3 hasAnchor" number="5.4.10">
<h3><span class="header-section-number">5.4.10</span> Contour map<a href="bestiary.html#contour-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to a heatmap we can make a contour map using <code>geom_density_2d()</code>. The way to read this figure is much the same way as you’d read a topographical map showing mountains or peaks. The central polygon represents the space (amongst shoot and leaf area) where there are most observations. As you “step” down this mountain to the next line, we step down in the number of counts. Think of this as showing where points are most clustered, as in <code>geom_bin2d()</code>.</p>
<p> </p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="bestiary.html#cb319-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> leafarea, <span class="at">y =</span> shootarea), <span class="at">data =</span> flower) <span class="sc">+</span></span>
<span id="cb319-2"><a href="bestiary.html#cb319-2" tabindex="-1"></a>    <span class="fu">geom_density2d</span>() <span class="sc">+</span></span>
<span id="cb319-3"><a href="bestiary.html#cb319-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="sc">+</span></span>
<span id="cb319-4"><a href="bestiary.html#cb319-4" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb319-5"><a href="bestiary.html#cb319-5" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/contour-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>We can then expand on this using the statistics layer, via <code>stat_nameOfStatistic</code>. For instance, we can use the calculated “level” (representing the height of contour) to fill in our figure. To do so, we’ll swap out <code>geom_density_2d()</code> for <code>stat_density_2d()</code> which will allow us to colour in the contour map.</p>
<p> </p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="bestiary.html#cb320-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> leafarea, <span class="at">y =</span> shootarea), <span class="at">data =</span> flower) <span class="sc">+</span></span>
<span id="cb320-2"><a href="bestiary.html#cb320-2" tabindex="-1"></a>    <span class="fu">stat_density_2d</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">stat</span>(level)), <span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-3"><a href="bestiary.html#cb320-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-4"><a href="bestiary.html#cb320-4" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb320-5"><a href="bestiary.html#cb320-5" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<pre><code>## Warning: `stat(level)` was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(level)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning
## was generated.</code></pre>
<p><img src="Rbook_files/figure-html/stat-contour-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>In this case it doesn’t look too pretty given that we don’t have a wide spread of data leading to partly formed polygons.</p>
</div>
<div id="cleveland-dotplot" class="section level3 hasAnchor" number="5.4.11">
<h3><span class="header-section-number">5.4.11</span> Cleveland dotplot<a href="bestiary.html#cleveland-dotplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The cleveland dotplot is a figure well suited to detect unusual observations (outliers?) in our data. The y axis is simply the order in which the data appears in the dataset. The x axis is our variable of interest. Points far to the left or far to the right are indicative of outliers. <code>ggplot2</code> does not have a geom specifically designed for a cleveland dotplot, though because of the grammar of graphics framework, we can build it ourselves.</p>
<p>We do this by first using the function <code>rownames()</code>. This function returns the row name of each row. In most data frames, the row names are simply numbers. Once we have this information, we can convert this to numbers using <code>as.numeric()</code>. After doing this we have a vector of numbers from 1 to 96. Keep in mind that such techniques can be used for any sort of figure we want to make. We’ll use the same technique to add horizontal lines for each row of data to replicate the traditional look of a dotchart.</p>
<p> </p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="bestiary.html#cb322-1" tabindex="-1"></a><span class="fu">ggplot</span>(flower) <span class="sc">+</span> </span>
<span id="cb322-2"><a href="bestiary.html#cb322-2" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(flower))), <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb322-3"><a href="bestiary.html#cb322-3" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-4"><a href="bestiary.html#cb322-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> leafarea, <span class="at">y =</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(flower)))) <span class="sc">+</span></span>
<span id="cb322-5"><a href="bestiary.html#cb322-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Order in Dataset&quot;</span>, <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">&quot;Area of leaf&quot;</span><span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb322-6"><a href="bestiary.html#cb322-6" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/dotpot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="pairs-plot" class="section level3 hasAnchor" number="5.4.12">
<h3><span class="header-section-number">5.4.12</span> Pairs plot<a href="bestiary.html#pairs-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the final figure we will need an additional package, called <code>GGally</code>. Within <code>GGally</code> is a function called <code>ggpairs()</code> which is equivalent to <code>pairs()</code> (part of base R). Both functions produce a scatterplot matrix of all variables of interest. Running diagonally down from left to right are plots showing distributions; either as stacked barcharts or as density plots, in this case coloured according to nitrogen concentration. The bottom plots show the plotted relationships, with variables on the top as the x axis, and the variables on the right plotted as the y axis. For example, the very bottom left plots shows the relationship between number of flowers on the y axis and treatment on the x axis, coloured according to nitrogen concentration. Conversely, the upper plots show either the correlation between variables, when both variables are continuous and the correlation can be calculated, boxplots when the plot is of a factor variable and a continuous variable, or as a stacked barchart when both variables are factors.</p>
<p>Such figures are a fantastic way to quickly show relationships in the dataset. They can of course be used to plot only part of the dataset, for instance using <code>flowers[ ,1:5]</code> to plot the first five columns of the dataset.</p>
<p>We’ve included two additional arguments in the code below. <code>cardinality_threshold =</code> forces <code>GGally</code> to plot all of the variables in our dataset (where it normally wants fewer variables) as well as <code>progress =</code> to avoid a progress bar appearing when we run the code.</p>
<p> </p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="bestiary.html#cb323-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb323-2"><a href="bestiary.html#cb323-2" tabindex="-1"></a>flower<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(flower<span class="sc">$</span>block)</span>
<span id="cb323-3"><a href="bestiary.html#cb323-3" tabindex="-1"></a></span>
<span id="cb323-4"><a href="bestiary.html#cb323-4" tabindex="-1"></a><span class="fu">ggpairs</span>(flower, <span class="fu">aes</span>(<span class="at">colour =</span> nitrogen), <span class="at">cardinality_threshold =</span> <span class="cn">NULL</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb323-5"><a href="bestiary.html#cb323-5" tabindex="-1"></a>    <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p><img src="Rbook_files/figure-html/pairs-plot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tips.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/05-gg_graphics.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rbook.pdf", "Download PDF version"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
