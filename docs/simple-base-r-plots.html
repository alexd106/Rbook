<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Simple base R plots | An Introduction to R</title>
  <meta name="description" content="4.2 Simple base R plots | An Introduction to R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Simple base R plots | An Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="4.2 Simple base R plots | An Introduction to R" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Simple base R plots | An Introduction to R" />
  
  <meta name="twitter:description" content="4.2 Simple base R plots | An Introduction to R" />
  

<meta name="author" content="Alex Douglas, Deon Roos, Francesca Mancini, Ana Couto &amp; David Lusseau" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="baseplot-start.html"/>
<link rel="next" href="custom-plot.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/font-awesome-5.3.1/css/fontawesome-all.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162377463-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162377463-3');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="the-aim-of-this-book.html"><a href="the-aim-of-this-book.html"><i class="fa fa-check"></i><b>0.1</b> The aim of this book</a></li>
<li class="chapter" data-level="0.2" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i><b>0.2</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.3" data-path="why-an-open-book.html"><a href="why-an-open-book.html"><i class="fa fa-check"></i><b>0.3</b> Why an open book?</a></li>
<li class="chapter" data-level="0.4" data-path="who-are-we.html"><a href="who-are-we.html"><i class="fa fa-check"></i><b>0.4</b> Who are we?</a></li>
<li class="chapter" data-level="0.5" data-path="book-website.html"><a href="book-website.html"><i class="fa fa-check"></i><b>0.5</b> Book website</a></li>
<li class="chapter" data-level="0.6" data-path="some-r-pointers.html"><a href="some-r-pointers.html"><i class="fa fa-check"></i><b>0.6</b> Some R pointers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install-r.html"><a href="install-r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install-r.html"><a href="install-r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install-r.html"><a href="install-r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install-r.html"><a href="install-r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install-r.html"><a href="install-r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a><ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio-orient.html"><a href="rstudio-orient.html#cons"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio-orient.html"><a href="rstudio-orient.html#environment-history-connections"><i class="fa fa-check"></i><b>1.3.2</b> Environment / History / Connections</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html#files-plots-packages-help-viewer"><i class="fa fa-check"></i><b>1.3.3</b> Files / Plots / Packages / Help / Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="packages.html"><a href="packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="packages.html"><a href="packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="packages.html"><a href="packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="packages.html"><a href="packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rsprojs.html"><a href="rsprojs.html"><i class="fa fa-check"></i><b>1.6</b> Projects in RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="work-d.html"><a href="work-d.html"><i class="fa fa-check"></i><b>1.7</b> Working directories</a></li>
<li class="chapter" data-level="1.8" data-path="dir-struct.html"><a href="dir-struct.html"><i class="fa fa-check"></i><b>1.8</b> Directory structure</a></li>
<li class="chapter" data-level="1.9" data-path="file-names.html"><a href="file-names.html"><i class="fa fa-check"></i><b>1.9</b> File names</a></li>
<li class="chapter" data-level="1.10" data-path="proj-doc.html"><a href="proj-doc.html"><i class="fa fa-check"></i><b>1.10</b> Project documentation</a></li>
<li class="chapter" data-level="1.11" data-path="r-style-guide.html"><a href="r-style-guide.html"><i class="fa fa-check"></i><b>1.11</b> R style guide</a></li>
<li class="chapter" data-level="1.12" data-path="backing-up-projects.html"><a href="backing-up-projects.html"><i class="fa fa-check"></i><b>1.12</b> Backing up projects</a></li>
<li class="chapter" data-level="1.13" data-path="citing-r.html"><a href="citing-r.html"><i class="fa fa-check"></i><b>1.13</b> Citing R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>2</b> Some R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="objects-in-r.html"><a href="objects-in-r.html"><i class="fa fa-check"></i><b>2.2</b> Objects in R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="objects-in-r.html"><a href="objects-in-r.html#r_objs"><i class="fa fa-check"></i><b>2.2.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="objects-in-r.html"><a href="objects-in-r.html#naming-objects"><i class="fa fa-check"></i><b>2.2.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-functions.html"><a href="r-functions.html"><i class="fa fa-check"></i><b>2.3</b> R functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r-functions.html"><a href="r-functions.html#funcs"><i class="fa fa-check"></i><b>2.3.1</b> Using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="vectors.html"><a href="vectors.html#extracting-elements"><i class="fa fa-check"></i><b>2.4.1</b> Extracting elements</a></li>
<li class="chapter" data-level="2.4.2" data-path="vectors.html"><a href="vectors.html#replacing-elements"><i class="fa fa-check"></i><b>2.4.2</b> Replacing elements</a></li>
<li class="chapter" data-level="2.4.3" data-path="vectors.html"><a href="vectors.html#vec_ord"><i class="fa fa-check"></i><b>2.4.3</b> Ordering elements</a></li>
<li class="chapter" data-level="2.4.4" data-path="vectors.html"><a href="vectors.html#vectorisation"><i class="fa fa-check"></i><b>2.4.4</b> Vectorisation</a></li>
<li class="chapter" data-level="2.4.5" data-path="vectors.html"><a href="vectors.html#na_vals"><i class="fa fa-check"></i><b>2.4.5</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>2.5</b> Getting help</a><ul>
<li class="chapter" data-level="2.5.1" data-path="help.html"><a href="help.html#r-help"><i class="fa fa-check"></i><b>2.5.1</b> R help</a></li>
<li class="chapter" data-level="2.5.2" data-path="help.html"><a href="help.html#rhelp"><i class="fa fa-check"></i><b>2.5.2</b> Other sources of help</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="saving-stuff-in-r.html"><a href="saving-stuff-in-r.html"><i class="fa fa-check"></i><b>2.6</b> Saving stuff in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-r.html"><a href="data-r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a><ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3.1</b> Data types</a></li>
<li class="chapter" data-level="3.2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3.2</b> Data structures</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-structures.html"><a href="data-structures.html#scal_vecs"><i class="fa fa-check"></i><b>3.2.1</b> Scalars and vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-structures.html"><a href="data-structures.html#mat_array"><i class="fa fa-check"></i><b>3.2.2</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.2.3</b> Lists</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-structures.html"><a href="data-structures.html#df"><i class="fa fa-check"></i><b>3.2.4</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3.3</b> Importing data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="importing-data.html"><a href="importing-data.html#saving-files-to-import"><i class="fa fa-check"></i><b>3.3.1</b> Saving files to import</a></li>
<li class="chapter" data-level="3.3.2" data-path="importing-data.html"><a href="importing-data.html#import_fnc"><i class="fa fa-check"></i><b>3.3.2</b> Import functions</a></li>
<li class="chapter" data-level="3.3.3" data-path="importing-data.html"><a href="importing-data.html#common-import-frustrations"><i class="fa fa-check"></i><b>3.3.3</b> Common import frustrations</a></li>
<li class="chapter" data-level="3.3.4" data-path="importing-data.html"><a href="importing-data.html#import_other"><i class="fa fa-check"></i><b>3.3.4</b> Other import options</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html"><i class="fa fa-check"></i><b>3.4</b> Wrangling data frames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#positional-indexes"><i class="fa fa-check"></i><b>3.4.1</b> Positional indexes</a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#logical-indexes"><i class="fa fa-check"></i><b>3.4.2</b> Logical indexes</a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#ordering-data-frames"><i class="fa fa-check"></i><b>3.4.3</b> Ordering data frames</a></li>
<li class="chapter" data-level="3.4.4" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#adding-columns-and-rows"><i class="fa fa-check"></i><b>3.4.4</b> Adding columns and rows</a></li>
<li class="chapter" data-level="3.4.5" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#merging-data-frames"><i class="fa fa-check"></i><b>3.4.5</b> Merging data frames</a></li>
<li class="chapter" data-level="3.4.6" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#reshape"><i class="fa fa-check"></i><b>3.4.6</b> Reshaping data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="summarising-data-frames.html"><a href="summarising-data-frames.html"><i class="fa fa-check"></i><b>3.5</b> Summarising data frames</a></li>
<li class="chapter" data-level="3.6" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>3.6</b> Exporting data</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exporting-data.html"><a href="exporting-data.html#export-functions"><i class="fa fa-check"></i><b>3.6.1</b> Export functions</a></li>
<li class="chapter" data-level="3.6.2" data-path="exporting-data.html"><a href="exporting-data.html#other-export-functions"><i class="fa fa-check"></i><b>3.6.2</b> Other export functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphics-base-r.html"><a href="graphics-base-r.html"><i class="fa fa-check"></i><b>4</b> Graphics with base R</a><ul>
<li class="chapter" data-level="4.1" data-path="baseplot-start.html"><a href="baseplot-start.html"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html"><i class="fa fa-check"></i><b>4.2</b> Simple base R plots</a><ul>
<li class="chapter" data-level="4.2.1" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#scatterplot"><i class="fa fa-check"></i><b>4.2.1</b> Scatterplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#box-and-violin-plots"><i class="fa fa-check"></i><b>4.2.3</b> Box and violin plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#dotcharts"><i class="fa fa-check"></i><b>4.2.4</b> Dot charts</a></li>
<li class="chapter" data-level="4.2.5" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#pairs-plots"><i class="fa fa-check"></i><b>4.2.5</b> Pairs plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#coplots"><i class="fa fa-check"></i><b>4.2.6</b> Coplots</a></li>
<li class="chapter" data-level="4.2.7" data-path="simple-base-r-plots.html"><a href="simple-base-r-plots.html#lattice-plots"><i class="fa fa-check"></i><b>4.2.7</b> Lattice plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="custom-plot.html"><a href="custom-plot.html"><i class="fa fa-check"></i><b>4.3</b> Customising plots</a><ul>
<li class="chapter" data-level="4.3.1" data-path="custom-plot.html"><a href="custom-plot.html#customising-with-arguments"><i class="fa fa-check"></i><b>4.3.1</b> Customising with arguments</a></li>
<li class="chapter" data-level="4.3.2" data-path="custom-plot.html"><a href="custom-plot.html#building-plots"><i class="fa fa-check"></i><b>4.3.2</b> Building plots</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="mult-graphs.html"><a href="mult-graphs.html"><i class="fa fa-check"></i><b>4.4</b> Multiple graphs</a></li>
<li class="chapter" data-level="4.5" data-path="export-plots.html"><a href="export-plots.html"><i class="fa fa-check"></i><b>4.5</b> Exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-r.html"><a href="graphics-r.html"><i class="fa fa-check"></i><b>5</b> Graphics with ggplot</a><ul>
<li class="chapter" data-level="5.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>5.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="5.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>5.2</b> The start of the end</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>5.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>5.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>5.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>5.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>5.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>5.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>5.3</b> Tips and tricks</a><ul>
<li class="chapter" data-level="5.3.1" data-path="tips.html"><a href="tips.html#statistics-layer"><i class="fa fa-check"></i><b>5.3.1</b> Statistics layer</a></li>
<li class="chapter" data-level="5.3.2" data-path="tips.html"><a href="tips.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>5.3.2</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="5.3.3" data-path="tips.html"><a href="tips.html#layering-layers"><i class="fa fa-check"></i><b>5.3.3</b> Layering layers</a></li>
<li class="chapter" data-level="5.3.4" data-path="tips.html"><a href="tips.html#continuous-colours"><i class="fa fa-check"></i><b>5.3.4</b> Continuous colours</a></li>
<li class="chapter" data-level="5.3.5" data-path="tips.html"><a href="tips.html#size-of-points"><i class="fa fa-check"></i><b>5.3.5</b> Size of points</a></li>
<li class="chapter" data-level="5.3.6" data-path="tips.html"><a href="tips.html#moving-the-legend"><i class="fa fa-check"></i><b>5.3.6</b> Moving the legend</a></li>
<li class="chapter" data-level="5.3.7" data-path="tips.html"><a href="tips.html#hiding-the-legend"><i class="fa fa-check"></i><b>5.3.7</b> Hiding the legend</a></li>
<li class="chapter" data-level="5.3.8" data-path="tips.html"><a href="tips.html#hiding-part-of-the-legend"><i class="fa fa-check"></i><b>5.3.8</b> Hiding part of the legend</a></li>
<li class="chapter" data-level="5.3.9" data-path="tips.html"><a href="tips.html#writing-on-a-figure"><i class="fa fa-check"></i><b>5.3.9</b> Writing on a figure</a></li>
<li class="chapter" data-level="5.3.10" data-path="tips.html"><a href="tips.html#ticks-and-tick-labels"><i class="fa fa-check"></i><b>5.3.10</b> Ticks and tick labels</a></li>
<li class="chapter" data-level="5.3.11" data-path="tips.html"><a href="tips.html#more-advanced-patchwork"><i class="fa fa-check"></i><b>5.3.11</b> More advanced patchwork</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bestiary.html"><a href="bestiary.html"><i class="fa fa-check"></i><b>5.4</b> A ggplot bestiary</a><ul>
<li class="chapter" data-level="5.4.1" data-path="bestiary.html"><a href="bestiary.html#density-plot"><i class="fa fa-check"></i><b>5.4.1</b> Density plot</a></li>
<li class="chapter" data-level="5.4.2" data-path="bestiary.html"><a href="bestiary.html#histogram"><i class="fa fa-check"></i><b>5.4.2</b> Histogram</a></li>
<li class="chapter" data-level="5.4.3" data-path="bestiary.html"><a href="bestiary.html#frequency-polygons"><i class="fa fa-check"></i><b>5.4.3</b> Frequency polygons</a></li>
<li class="chapter" data-level="5.4.4" data-path="bestiary.html"><a href="bestiary.html#boxplot"><i class="fa fa-check"></i><b>5.4.4</b> Boxplot</a></li>
<li class="chapter" data-level="5.4.5" data-path="bestiary.html"><a href="bestiary.html#violin-plots"><i class="fa fa-check"></i><b>5.4.5</b> Violin plots</a></li>
<li class="chapter" data-level="5.4.6" data-path="bestiary.html"><a href="bestiary.html#barchart"><i class="fa fa-check"></i><b>5.4.6</b> Barchart</a></li>
<li class="chapter" data-level="5.4.7" data-path="bestiary.html"><a href="bestiary.html#quantile-lines"><i class="fa fa-check"></i><b>5.4.7</b> Quantile lines</a></li>
<li class="chapter" data-level="5.4.8" data-path="bestiary.html"><a href="bestiary.html#heatmap"><i class="fa fa-check"></i><b>5.4.8</b> Heatmap</a></li>
<li class="chapter" data-level="5.4.9" data-path="bestiary.html"><a href="bestiary.html#hex-map"><i class="fa fa-check"></i><b>5.4.9</b> Hex map</a></li>
<li class="chapter" data-level="5.4.10" data-path="bestiary.html"><a href="bestiary.html#contour-map"><i class="fa fa-check"></i><b>5.4.10</b> Contour map</a></li>
<li class="chapter" data-level="5.4.11" data-path="bestiary.html"><a href="bestiary.html#cleveland-dotplot"><i class="fa fa-check"></i><b>5.4.11</b> Cleveland dotplot</a></li>
<li class="chapter" data-level="5.4.12" data-path="bestiary.html"><a href="bestiary.html#pairs-plot"><i class="fa fa-check"></i><b>5.4.12</b> Pairs plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stats-r.html"><a href="stats-r.html"><i class="fa fa-check"></i><b>6</b> Simple Statistics in R</a><ul>
<li class="chapter" data-level="6.1" data-path="one-and-two-sample-tests.html"><a href="one-and-two-sample-tests.html"><i class="fa fa-check"></i><b>6.1</b> One and two sample tests</a></li>
<li class="chapter" data-level="6.2" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>6.2</b> Correlation</a></li>
<li class="chapter" data-level="6.3" data-path="simple-lm.html"><a href="simple-lm.html"><i class="fa fa-check"></i><b>6.3</b> Simple linear modelling</a></li>
<li class="chapter" data-level="6.4" data-path="other-modelling-approaches.html"><a href="other-modelling-approaches.html"><i class="fa fa-check"></i><b>6.4</b> Other modelling approaches</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prog-r.html"><a href="prog-r.html"><i class="fa fa-check"></i><b>7</b> Programming in R</a><ul>
<li class="chapter" data-level="7.1" data-path="looking-behind-the-curtain.html"><a href="looking-behind-the-curtain.html"><i class="fa fa-check"></i><b>7.1</b> Looking behind the curtain</a></li>
<li class="chapter" data-level="7.2" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>7.2</b> Functions in R</a></li>
<li class="chapter" data-level="7.3" data-path="conditional-statements.html"><a href="conditional-statements.html"><i class="fa fa-check"></i><b>7.3</b> Conditional statements</a></li>
<li class="chapter" data-level="7.4" data-path="is-it-gonna-be-a-good-day.html"><a href="is-it-gonna-be-a-good-day.html"><i class="fa fa-check"></i><b>7.4</b> “Is it gonna be a good day?”</a></li>
<li class="chapter" data-level="7.5" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>7.5</b> Loops</a><ul>
<li class="chapter" data-level="7.5.1" data-path="loops.html"><a href="loops.html#for-loop"><i class="fa fa-check"></i><b>7.5.1</b> For loop</a></li>
<li class="chapter" data-level="7.5.2" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i><b>7.5.2</b> While loop</a></li>
<li class="chapter" data-level="7.5.3" data-path="loops.html"><a href="loops.html#when-to-use-a-loop"><i class="fa fa-check"></i><b>7.5.3</b> When to use a loop?</a></li>
<li class="chapter" data-level="7.5.4" data-path="loops.html"><a href="loops.html#if-not-loops-then-what"><i class="fa fa-check"></i><b>7.5.4</b> If not loops, then what?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rmarkdown-r.html"><a href="rmarkdown-r.html"><i class="fa fa-check"></i><b>8</b> Reproducible reports with R markdown</a><ul>
<li class="chapter" data-level="8.1" data-path="what-is-r-markdown.html"><a href="what-is-r-markdown.html"><i class="fa fa-check"></i><b>8.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="8.2" data-path="why-use-r-markdown.html"><a href="why-use-r-markdown.html"><i class="fa fa-check"></i><b>8.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="8.3" data-path="get-started-with-r-markdown.html"><a href="get-started-with-r-markdown.html"><i class="fa fa-check"></i><b>8.3</b> Get started with R markdown</a></li>
<li class="chapter" data-level="8.4" data-path="new-rm.html"><a href="new-rm.html"><i class="fa fa-check"></i><b>8.4</b> Create an R markdown document</a></li>
<li class="chapter" data-level="8.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html"><i class="fa fa-check"></i><b>8.5</b> R markdown anatomy</a><ul>
<li class="chapter" data-level="8.5.1" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#yaml-header"><i class="fa fa-check"></i><b>8.5.1</b> YAML header</a></li>
<li class="chapter" data-level="8.5.2" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#formatted-text"><i class="fa fa-check"></i><b>8.5.2</b> Formatted text</a></li>
<li class="chapter" data-level="8.5.3" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#code_chunks"><i class="fa fa-check"></i><b>8.5.3</b> Code chunks</a></li>
<li class="chapter" data-level="8.5.4" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-figures"><i class="fa fa-check"></i><b>8.5.4</b> Adding figures</a></li>
<li class="chapter" data-level="8.5.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-tables"><i class="fa fa-check"></i><b>8.5.5</b> Adding tables</a></li>
<li class="chapter" data-level="8.5.6" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#inline-r-code"><i class="fa fa-check"></i><b>8.5.6</b> Inline R code</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="tips-tricks.html"><a href="tips-tricks.html"><i class="fa fa-check"></i><b>8.6</b> Some tips and tricks</a></li>
<li class="chapter" data-level="8.7" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>8.7</b> Further Information</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="github-r.html"><a href="github-r.html"><i class="fa fa-check"></i><b>9</b> Version control with Git and GitHub</a><ul>
<li class="chapter" data-level="9.1" data-path="what-is-version-control.html"><a href="what-is-version-control.html"><i class="fa fa-check"></i><b>9.1</b> What is version control?</a></li>
<li class="chapter" data-level="9.2" data-path="why-use-version-control.html"><a href="why-use-version-control.html"><i class="fa fa-check"></i><b>9.2</b> Why use version control?</a></li>
<li class="chapter" data-level="9.3" data-path="what-is-git-and-github.html"><a href="what-is-git-and-github.html"><i class="fa fa-check"></i><b>9.3</b> What is Git and GitHub?</a></li>
<li class="chapter" data-level="9.4" data-path="setup-git.html"><a href="setup-git.html"><i class="fa fa-check"></i><b>9.4</b> Getting started</a><ul>
<li class="chapter" data-level="9.4.1" data-path="setup-git.html"><a href="setup-git.html#install-git"><i class="fa fa-check"></i><b>9.4.1</b> Install Git</a></li>
<li class="chapter" data-level="9.4.2" data-path="setup-git.html"><a href="setup-git.html#configure-git"><i class="fa fa-check"></i><b>9.4.2</b> Configure Git</a></li>
<li class="chapter" data-level="9.4.3" data-path="setup-git.html"><a href="setup-git.html#rs_config"><i class="fa fa-check"></i><b>9.4.3</b> Configure RStudio</a></li>
<li class="chapter" data-level="9.4.4" data-path="setup-git.html"><a href="setup-git.html#register-a-github-account"><i class="fa fa-check"></i><b>9.4.4</b> Register a GitHub account</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html"><i class="fa fa-check"></i><b>9.5</b> Setting up a project in RStudio</a><ul>
<li class="chapter" data-level="9.5.1" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt1"><i class="fa fa-check"></i><b>9.5.1</b> Option 1 - GitHub first</a></li>
<li class="chapter" data-level="9.5.2" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt2"><i class="fa fa-check"></i><b>9.5.2</b> Option 2 - RStudio first</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="use-git.html"><a href="use-git.html"><i class="fa fa-check"></i><b>9.6</b> Using Git</a><ul>
<li class="chapter" data-level="9.6.1" data-path="use-git.html"><a href="use-git.html#tracking-changes"><i class="fa fa-check"></i><b>9.6.1</b> Tracking changes</a></li>
<li class="chapter" data-level="9.6.2" data-path="use-git.html"><a href="use-git.html#commit-history"><i class="fa fa-check"></i><b>9.6.2</b> Commit history</a></li>
<li class="chapter" data-level="9.6.3" data-path="use-git.html"><a href="use-git.html#undo"><i class="fa fa-check"></i><b>9.6.3</b> Reverting changes</a></li>
<li class="chapter" data-level="9.6.4" data-path="use-git.html"><a href="use-git.html#collab"><i class="fa fa-check"></i><b>9.6.4</b> Collaborate with Git</a></li>
<li class="chapter" data-level="9.6.5" data-path="use-git.html"><a href="use-git.html#git-tips"><i class="fa fa-check"></i><b>9.6.5</b> Git tips</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>9.7</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>10</b> Appendix</a><ul>
<li class="chapter" data-level="10.1" data-path="install-rm.html"><a href="install-rm.html"><i class="fa fa-check"></i><b>10.1</b> Installing R Markdown</a><ul>
<li class="chapter" data-level="10.1.1" data-path="install-rm.html"><a href="install-rm.html#ms-windows"><i class="fa fa-check"></i><b>10.1.1</b> MS Windows</a></li>
<li class="chapter" data-level="10.1.2" data-path="install-rm.html"><a href="install-rm.html#mac-osx"><i class="fa fa-check"></i><b>10.1.2</b> Mac OSX</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-base-r-plots" class="section level2">
<h2><span class="header-section-number">4.2</span> Simple base R plots</h2>
<p>There are many functions in R to produce plots ranging from the very basic to the highly complex. It’s impossible to cover every aspect of producing graphics in R in this introductory book so we’ll introduce you to most of the common methods of graphing data and describe how to customise your graphs later on in this <a href="custom-plot.html#custom_plot">Chapter</a>.</p>
<div id="scatterplot" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Scatterplots</h3>
<p>The most common high level function used to produce plots in R is (rather unsurprisingly) the <code>plot()</code> function. For example, let’s plot the <code>weight</code> of petunia plants from our <code>flowers</code> data frame which we imported in <a href="importing-data.html#import_fnc">Chapter 3</a>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">flowers &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> <span class="st">&#39;data/flower.txt&#39;</span>, </a>
<a class="sourceLine" id="cb180-2" data-line-number="2">                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb180-3" data-line-number="3"></a>
<a class="sourceLine" id="cb180-4" data-line-number="4"><span class="kw">plot</span>(flowers<span class="op">$</span>weight)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot1-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>R has plotted the values of <code>weight</code> (on the y axis) against an index since we are only plotting one variable to plot. The index is just the order of the <code>weight</code> values in the data frame (1 first in the data frame and 97 last). The <code>weight</code> variable name has been automatically included as a y axis label and the axes scales have been automatically set.</p>
<p>If we’d only included the variable <code>weight</code> rather than <code>flowers$weight</code>, the <code>plot()</code> function will display an error as the variable <code>weight</code> only exists in the <code>flowers</code> data frame object.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="kw">plot</span>(weight)</a>
<a class="sourceLine" id="cb181-2" data-line-number="2">Error <span class="cf">in</span> <span class="kw">plot</span>(weight) <span class="op">:</span><span class="st"> </span>object <span class="st">&#39;weight&#39;</span> not found</a></code></pre></div>
<p>As many of the base R plotting functions don’t have a <code>data =</code> argument to specify the data frame name directly we can use the <code>with()</code> function in combination with <code>plot()</code> as a shortcut.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="kw">with</span>(flowers, <span class="kw">plot</span>(weight)) </a></code></pre></div>
<p>To plot a scatterplot of one numeric variable against another numeric variable we just need to include both variables as arguments when using the <code>plot()</code> function. For example to plot <code>shootarea</code> on the y axis and <code>weight</code> of the x axis.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw">plot</span>(<span class="dt">x =</span> flowers<span class="op">$</span>weight, <span class="dt">y =</span> flowers<span class="op">$</span>shootarea)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot4-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>There is an equivalent approach for these types of plots which often causes some confusion at first. You can also use the formula notation when using the <code>plot()</code> function. However, in contrast to the previous method the formula method requires you to specify the y axis variable first, then a <code>~</code> and then our x axis variable.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">plot</span>(flowers<span class="op">$</span>shootarea <span class="op">~</span><span class="st"> </span>flowers<span class="op">$</span>weight)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot5-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Both of these two approaches are equivalent so we suggest that you just choose the one you prefer and go with it.</p>
<p>You can also specify the type of graph you wish to plot using the argument <code>type =</code>. You can plot just the points (<code>type = &quot;p&quot;</code>, this is the default), just lines (<code>type = &quot;l&quot;</code>), both points and lines connected (<code>type = &quot;b&quot;</code>), both points and lines with the lines running through the points (<code>type = &quot;o&quot;</code>) and empty points joined by lines (<code>type = &quot;c&quot;</code>). For example, let’s use our skills from <a href="r-functions.html#funcs">Chapter 2</a> to generate two vectors of numbers (<code>my_x</code> and <code>my_y</code>) and then plot one against the other using different <code>type =</code> values to see what type of plots are produced. Don’t worry about the <code>par(mfrow = c(2, 2))</code> line of code yet. We’re just using this to split the plotting device so we can fit all four plots on the same device to save some space. See <a href="mult-graphs.html#mult_graphs">later</a> in the Chapter for more details about this. The top left plot is <code>type = &quot;l&quot;</code>, the top right <code>type = &quot;b&quot;</code>, bottom left <code>type = &quot;o&quot;</code> and bottom right is <code>type = &quot;c&quot;</code>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1">my_x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb185-2" data-line-number="2">my_y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb185-3" data-line-number="3"></a>
<a class="sourceLine" id="cb185-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb185-5" data-line-number="5"><span class="kw">plot</span>(my_x, my_y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb185-6" data-line-number="6"><span class="kw">plot</span>(my_x, my_y, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a>
<a class="sourceLine" id="cb185-7" data-line-number="7"><span class="kw">plot</span>(my_x, my_y, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a>
<a class="sourceLine" id="cb185-8" data-line-number="8"><span class="kw">plot</span>(my_x, my_y, <span class="dt">type =</span> <span class="st">&quot;c&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot6-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Admittedly the plots we’ve produced so far don’t look anything particularly special. However, the <code>plot()</code> function is incredibly versatile and can generate a large range of plots which you can customise to your own taste. We’ll cover how to customise plots <a href="custom-plot.html#custom_plot">later</a> in the Chapter. As a quick aside, the <code>plot()</code> function is also what’s known as a generic function which means it can change it’s default behaviour depending on the type of object used as an argument. You will see an example of this in <a href="simple-lm.html#simple_lm">Chapter 6</a> where we use the <code>plot()</code> function to generate diagnostic plots of residuals from a linear model object (bet you can’t wait!).</p>
</div>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Histograms</h3>
<p>Frequency histograms are useful when you want to get an idea about the distribution of values in a numeric variable. The <code>hist()</code> function takes a numeric vector as its main argument. Let’s generate a histogram of the <code>height</code> values.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="kw">hist</span>(flowers<span class="op">$</span>height)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot7-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The <code>hist()</code> function automatically creates the breakpoints (or bins) in the histogram using the <a href="https://en.wikipedia.org/wiki/Histogram">Sturges</a> formula unless you specify otherwise by using the <code>break =</code> argument. For example, let’s say we want to plot our histogram with breakpoints every 1 cm flower height. We first generate a sequence from zero to the maximum value of <code>height</code> (18 rounded up) in steps of 1 using the <code>seq()</code> function. We can then use this sequence with the <code>breaks =</code> argument. While we’re at it, let’s also replace the ugly title for something a little better using the <code>main =</code> argument</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1">brk &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">18</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb187-2" data-line-number="2"><span class="kw">hist</span>(flowers<span class="op">$</span>height, <span class="dt">breaks =</span> brk, <span class="dt">main =</span> <span class="st">&quot;petunia height&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot8-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can also display the histogram as a proportion rather than a frequency by using the <code>freq = FALSE</code> argument.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">brk &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">18</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb188-2" data-line-number="2"><span class="kw">hist</span>(flowers<span class="op">$</span>height, <span class="dt">breaks =</span> brk, <span class="dt">main =</span> <span class="st">&quot;petunia height&quot;</span>,</a>
<a class="sourceLine" id="cb188-3" data-line-number="3">      <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot9-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>An alternative to plotting just a straight up histogram is to add a <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">kernel density</a> curve to the plot. You can superimpose a density curve onto the histogram by first using the <code>density()</code> function to compute the kernel density estimates and then use the low level function <code>lines()</code> to add these estimates onto the plot as a line.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">dens &lt;-<span class="st"> </span><span class="kw">density</span>(flowers<span class="op">$</span>height)</a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="kw">hist</span>(flowers<span class="op">$</span>height, <span class="dt">breaks =</span> brk, <span class="dt">main =</span> <span class="st">&quot;petunia height&quot;</span>,</a>
<a class="sourceLine" id="cb189-3" data-line-number="3">      <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb189-4" data-line-number="4"><span class="kw">lines</span>(dens)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot10-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="box-and-violin-plots" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Box and violin plots</h3>
<p>OK, we’ll just come and out and say it, we love boxplots and their close relation the violin plot. Boxplots (or box-and-whisker plots to give them their full name) are very useful when you want to graphically summarise the distribution of a variable, identify potential unusual values and compare distributions between different groups. The reason we love them is their ease of interpretation, transparency and relatively high data-to-ink ratio (i.e. they convey lots of information efficiently). We suggest that you try to use boxplots as much as possible when exploring your data and avoid the temptation to use the more ubiquitous bar plot (even with standard error or 95% confidence intervals bars). The problem with bar plots (aka dynamite plots) is that they hide important information from the reader such as the distribution of the data and assume that the error bars (or confidence intervals) are symmetric around the mean. Of course, it’s up to you what you do but if you’re tempted to use bar plots just Google ‘dynamite plots are evil’ or see <a href="http://biostat.mc.vanderbilt.edu/wiki/pub/Main/TatsukiRcode/Poster3.pdf">here</a> or <a href="https://thenode.biologists.com/leaving-bar-five-steps/research/">here</a> for a fuller discussion.</p>
<p>To create a boxplot in R we use the <code>boxplot()</code> function. For example, let’s create a boxplot of the variable <code>weight</code> from our <code>flowers</code> data frame. We can also include a y axis label using the <code>ylab =</code> argument.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="kw">boxplot</span>(flowers<span class="op">$</span>weight, <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot11-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The thick horizontal line in the middle of the box is the median value of <code>weight</code> (around 11 g). The upper line of the box is the upper quartile (75<sup>th</sup> percentile) and the lower line is the lower quartile (25<sup>th</sup> percentile). The distance between the upper and lower quartiles is known as the inter quartile range and represents the values of <code>weight</code> for 50% of the data. The dotted vertical lines are called the whiskers and their length is determined as 1.5 x the inter quartile range. Data points that are plotted outside the the whiskers represent potential unusual observations. This doesn’t mean they are unusual, just that they warrant a closer look. We recommend using boxplots in combination with Cleveland dotplots to identify potential unusual observations (see the <a href="simple-base-r-plots.html#dotcharts">next</a> section of this Chapter for more details). The neat thing about boxplots is that they not only provide a measure of central tendency (the median value) they also give you an idea about the distribution of the data. If the median line is more or less in the middle of the box (between the upper and lower quartiles) and the whiskers are more or less the same length then you can be reasonably sure the distribution of your data is symmetrical.</p>
<p>If we want examine how the distribution of a variable changes between different levels of a factor we need to use the formula notation with the <code>boxplot()</code> function. For example, let’s plot our <code>weight</code> variable again, but this time see how this changes with each level of <code>nitrogen</code>. When we use the formula notation with <code>boxplot()</code> we can use the <code>data =</code> argument to save some typing. We’ll also introduce an x axis label using the <code>xlab =</code> argument.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="kw">boxplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen, <span class="dt">data =</span> flowers, </a>
<a class="sourceLine" id="cb191-2" data-line-number="2">         <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;nitrogen level&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot12-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The factor levels are plotted in the same order defined by our factor variable <code>nitrogen</code> (often alphabetically). To change the order we need to change the order of our levels of the <code>nitrogen</code> factor in our data frame using the <code>factor()</code> function and then re-plot the graph. Let’s plot our boxplot with our factor levels going from <code>low</code> to <code>high</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1">flowers<span class="op">$</span>nitrogen &lt;-<span class="st"> </span><span class="kw">factor</span>(flowers<span class="op">$</span>nitrogen, </a>
<a class="sourceLine" id="cb192-2" data-line-number="2">                            <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))</a>
<a class="sourceLine" id="cb192-3" data-line-number="3"><span class="kw">boxplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen, <span class="dt">data =</span> flowers, </a>
<a class="sourceLine" id="cb192-4" data-line-number="4">          <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;nitrogen level&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot13-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also group our variables by two factors in the same plot. Let’s plot our <code>weight</code> variable but this time plot a separate box for each <code>nitrogen</code> and treatment (<code>treat</code>) combination.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw">boxplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen <span class="op">*</span><span class="st"> </span>treat, <span class="dt">data =</span> flowers, </a>
<a class="sourceLine" id="cb193-2" data-line-number="2">         <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;nitrogen level&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot14-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This plot looks OK, but some of the group labels are hidden as they’re too long to fit on the plot. There are a couple of ways to deal with this. Perhaps the easiest is to reduce the font size of the tick mark labels in the plot so they all fit using the <code>cex.axis =</code> argument. Let’s set the font size to be 30% smaller than the default with <code>cex.axis = 0.7</code>. We’ll show you how to further customise plots <a href="custom-plot.html#custom_plot">later</a> on in the Chapter.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1"><span class="kw">boxplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen <span class="op">*</span><span class="st"> </span>treat, <span class="dt">data =</span> flowers, </a>
<a class="sourceLine" id="cb194-2" data-line-number="2">         <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;nitrogen level&quot;</span>, </a>
<a class="sourceLine" id="cb194-3" data-line-number="3">         <span class="dt">cex.axis =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot15-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Violin plots are like a combination of a boxplot and a kernel density plot (you saw an example of a kernel density plot in the histogram section above) all rolled into one figure. We can create a violin plot in R using the <code>vioplot()</code> function from the <code>vioplot</code> package. You’ll need to first install this package using <code>install.packages('vioplot')</code> function as usual. The nice thing about the <code>vioplot()</code> function is that you use it in pretty much the same way you would use the <code>boxplot()</code> function. We’ll also use the argument <code>col = &quot;lightblue&quot;</code> to change the fill colour to light blue.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">library</span>(vioplot)</a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="kw">vioplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen, <span class="dt">data =</span> flowers, </a>
<a class="sourceLine" id="cb195-3" data-line-number="3">         <span class="dt">ylab =</span> <span class="st">&quot;weight (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;nitrogen level&quot;</span>,</a>
<a class="sourceLine" id="cb195-4" data-line-number="4">         <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot16-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In the violin plot above we have our familiar boxplot for each <code>nitrogen</code> level but this time the median value is represented by a white circle. Plotted around each boxplot is the kernel density plot which represents the distribution of the data for each nitrogen level.</p>
</div>
<div id="dotcharts" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Dot charts</h3>
<p>Identifying unusual observations (aka outliers) in numeric variables is extremely important as they may influence parameter estimates in your statistical model or indicate an error in your data. A really useful (if undervalued) plot to help identify outliers is the Cleveland dotplot. You can produce a dotplot in R very simply by using the <code>dotchart()</code> function.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="kw">dotchart</span>(flowers<span class="op">$</span>height)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot17-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In the dotplot above the data from the <code>height</code> variable is plotted along the x axis and the data is plotted in the order it occurs in the <code>flowers</code> data frame on the y axis (values near the top of the y axis occur later in the data frame with those lower down occurring at the beginning of the data frame). In this plot we have a single value extending to the right at about 17 cm but it doesn’t appear particularly large compared to the rest. An example of a dotplot with an unusual observation is given below.</p>
<p><img src="Rbook_files/figure-html/plot18-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also group the values in our <code>height</code> variable by a factor variable such as <code>nitrogen</code> using the <code>groups =</code> argument. This is useful for identifying unusual observations within a factor level that might be obscured when looking at all the data together.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="kw">dotchart</span>(flowers<span class="op">$</span>height, <span class="dt">groups =</span> flowers<span class="op">$</span>nitrogen)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot19-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="pairs-plots" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Pairs plots</h3>
<p>Previously in this Chapter we used the <code>plot()</code> function to create a scatterplot to explore the relationship between two numeric variables. With datasets that contain many numeric variables, it’s often handy to create multiple scatterplots to visualise relationships between all these variables. We could use the <code>plot()</code> function to create each of these plot individually, but a much easier way is to use the <code>pairs()</code> function. The <code>pairs()</code> function creates a multi-panel scatterplot (sometimes called a scatterplot matrix) which plots all combinations of variables. Let’s create a multi-panel scatterplot of all of the numeric variables in our <code>flowers</code> data frame. Note, you may need to click on the ‘Zoom’ button in RStudio to display the plot clearly.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1"><span class="kw">pairs</span>(flowers[, <span class="kw">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;leafarea&quot;</span>, </a>
<a class="sourceLine" id="cb198-2" data-line-number="2">                <span class="st">&quot;shootarea&quot;</span>, <span class="st">&quot;flowers&quot;</span>)])</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot20-1.png" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="co"># or we could use the equivalent</span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2"><span class="co"># pairs(flowers[, 4:8])</span></a></code></pre></div>
<p>Interpretation of the pairs plot takes a bit of getting used to. The panels on the diagonal give the variable names. The first row of plots displays the <code>height</code> variable on the y axis and the variables <code>weight</code>, <code>leafarea</code>, <code>shootarea</code> and <code>flowers</code> on the x axis for each of the four plots respectively. The next row of plots have <code>weight</code> on the y axis and <code>height</code>, <code>leafarea</code>, <code>shootarea</code> and <code>flowers</code> on the x axis. We interpret the rest of the rows in the same way with the last row displaying the <code>flowers</code> variable on the y axis and the other variables on the x axis. Hopefully you’ll notice that the plots below the diagonal are the same plots as those above the diagonal just with the axis reversed.</p>
<p>We can also add additional information to each of our plots by including a panel function when we use the <code>pairs()</code> function. For example, to add a <a href="https://en.wikipedia.org/wiki/Local_regression">LOWESS</a> (locally weighted scatterplot smoothing) smoother to each of the panels we just need to add the argument <code>panel = panel.smooth</code>.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1"><span class="kw">pairs</span>(flowers[, <span class="kw">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;leafarea&quot;</span>, </a>
<a class="sourceLine" id="cb200-2" data-line-number="2">                <span class="st">&quot;shootarea&quot;</span>, <span class="st">&quot;flowers&quot;</span>)], </a>
<a class="sourceLine" id="cb200-3" data-line-number="3">                 <span class="dt">panel =</span> panel.smooth)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot21-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If you take a look at the help file for the <code>pairs()</code> function (<code>?pairs</code>) you’ll find a few more useful panel functions in the ‘Examples’ section. To use these functions you’ll first need to copy the code and paste it into the Console in RStudio (we go into more detail about defining functions in <a href="prog-r.html#prog_r">Chapter 7</a>). For example, the <code>panel.cor()</code> function calculates the absolute correlation coefficient between two variables and adjusts the size of the displayed coefficient depending on the value (higher coefficient values are bigger). Don’t worry if you don’t understand this code just yet, for the moment we just need to know how to use it (it might be fun to try and figure it out though!).</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1">panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...)</a>
<a class="sourceLine" id="cb201-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb201-3" data-line-number="3">    usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))</a>
<a class="sourceLine" id="cb201-4" data-line-number="4">    <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb201-5" data-line-number="5">    r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y))</a>
<a class="sourceLine" id="cb201-6" data-line-number="6">    txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits =</span> digits)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb201-7" data-line-number="7">    txt &lt;-<span class="st"> </span><span class="kw">paste0</span>(prefix, txt)</a>
<a class="sourceLine" id="cb201-8" data-line-number="8">    <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex.cor &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)</a>
<a class="sourceLine" id="cb201-9" data-line-number="9">    <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex.cor <span class="op">*</span><span class="st"> </span>r)</a>
<a class="sourceLine" id="cb201-10" data-line-number="10">}</a></code></pre></div>
<p>Once we’ve copied and pasted this code into the Console we can use the <code>panel.cor()</code> function to replace the plots below the diagonal with the correlation coefficient using the <code>lower.panel =</code> argument.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1"><span class="kw">pairs</span>(flowers[, <span class="kw">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;leafarea&quot;</span>, </a>
<a class="sourceLine" id="cb202-2" data-line-number="2">                <span class="st">&quot;shootarea&quot;</span>, <span class="st">&quot;flowers&quot;</span>)], </a>
<a class="sourceLine" id="cb202-3" data-line-number="3">                 <span class="dt">lower.panel =</span> panel.cor)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot23-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Another useful function in the ‘Examples’ section is the <code>panel.hist()</code> function. This function generates a histogram of each of the variables in the plot. To use it, we must again copy the code and paste it into the Console in RStudio.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1">panel.hist &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)</a>
<a class="sourceLine" id="cb203-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb203-3" data-line-number="3">    usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))</a>
<a class="sourceLine" id="cb203-4" data-line-number="4">    <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(usr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) )</a>
<a class="sourceLine" id="cb203-5" data-line-number="5">    h &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb203-6" data-line-number="6">    breaks &lt;-<span class="st"> </span>h<span class="op">$</span>breaks; nB &lt;-<span class="st"> </span><span class="kw">length</span>(breaks)</a>
<a class="sourceLine" id="cb203-7" data-line-number="7">    y &lt;-<span class="st"> </span>h<span class="op">$</span>counts; y &lt;-<span class="st"> </span>y<span class="op">/</span><span class="kw">max</span>(y)</a>
<a class="sourceLine" id="cb203-8" data-line-number="8">    <span class="kw">rect</span>(breaks[<span class="op">-</span>nB], <span class="dv">0</span>, breaks[<span class="op">-</span><span class="dv">1</span>], y, <span class="dt">col =</span> <span class="st">&quot;cyan&quot;</span>, ...)</a>
<a class="sourceLine" id="cb203-9" data-line-number="9">}</a></code></pre></div>
<p>We can then include it in our <code>pairs()</code> function to place the histograms on the diagonal set of panels using the <code>diag.panel = panel.hist</code> argument. Let’s also apply the <code>panel.smooth()</code> function to the plots above the diagonal while we’re at it using the <code>upper.panel = panel.smooth</code> argument.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">pairs</span>(flowers[, <span class="kw">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;leafarea&quot;</span>, </a>
<a class="sourceLine" id="cb204-2" data-line-number="2">                <span class="st">&quot;shootarea&quot;</span>, <span class="st">&quot;flowers&quot;</span>)], </a>
<a class="sourceLine" id="cb204-3" data-line-number="3">                 <span class="dt">lower.panel =</span> panel.cor,</a>
<a class="sourceLine" id="cb204-4" data-line-number="4">                 <span class="dt">diag.panel =</span> panel.hist,</a>
<a class="sourceLine" id="cb204-5" data-line-number="5">                 <span class="dt">upper.panel =</span> panel.smooth)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot25-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="coplots" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Coplots</h3>
<p>When examining the relationship between two numeric variables, it is often useful to be able to determine whether a third variable is obscuring or changing any relationship. A really handy plot to use in these situations is a conditioning plot (also known as conditional scatterplot plot) which we can create in R by using the <code>coplot()</code> function. The <code>coplot()</code> function plots two variables but each plot is conditioned (<code>|</code>) by a third variable. This third variable can be either numeric or a factor. As an example, let’s look at how the relationship between the number of flowers (<code>flowers</code> variable) and the <code>weight</code> of petunia plants changes dependent on <code>leafarea</code>. Note the <code>coplot()</code> function has a <code>data =</code> argument so no need to use the <code>$</code> notation.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw">coplot</span>(flowers <span class="op">~</span><span class="st"> </span>weight<span class="op">|</span>leafarea, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot26-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>It takes a little practice to interpret coplots. The number of flowers is plotted on the y axis and the weight of plants on the x axis. The six plots show the relationship between these two variables for different ranges of leaf area. The bar plot at the top indicates the range of leaf area values for each of the plots. The panels are read from bottom left to top right along each row. For example, the bottom left panel shows the relationship between number of flowers and weight for plants with the lowest range of leaf area values (approximately 5 - 11 cm<sup>2</sup>). The top right plot shows the relationship between flowers and weight for plants with a leaf area ranging from approximately 16 - 50 cm<sup>2</sup>. Notice that the range of values for leaf area differs between panels and that the ranges overlap from panel to panel. The <code>coplot()</code> function does it’s best to split the data up to ensure there are an adequate number of data points in each panel. If you don’t want to produce plots with overlapping data in the panel you can set the <code>overlap =</code> argument to <code>overlap = 0</code></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="kw">coplot</span>(flowers <span class="op">~</span><span class="st"> </span>weight<span class="op">|</span>leafarea, <span class="dt">data =</span> flowers, <span class="dt">overlap =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot27-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can also use the <code>coplot()</code> function with factor conditioning variables. For example, we can examine the relationship between <code>flowers</code> and <code>weight</code> variables conditioned on the factor <code>nitrogen</code>. Again, the bottom left plot is the relationship between <code>flowers</code> and <code>weight</code> for those plants in the <code>high</code> nitrogen treatment. The top left plot shows the same relationship but for plants in the <code>high</code> nitrogen treatment.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">coplot</span>(flowers <span class="op">~</span><span class="st"> </span>weight<span class="op">|</span>nitrogen, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot28-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can even use two conditioning variables (either numeric or factors). Let’s look at the relationship between <code>flowers</code> and <code>height</code> but this time condition on both <code>nitrogen</code> and <code>treat</code>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="kw">coplot</span>(flowers <span class="op">~</span><span class="st"> </span>weight<span class="op">|</span>nitrogen <span class="op">*</span><span class="st"> </span>treat, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot29-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The bottom row of plots are for plants in the <code>notip</code> treatment and the top row for plants in the <code>tip</code> treatment. So the bottom left plot shows the relationship between <code>flowers</code> and <code>weight</code> for plants grown in <code>low</code> nitrogen with the <code>notip</code> treatment. The top right plot are those plants grown in <code>high</code> nitrogen with the <code>tip</code> treatment.</p>
<p>Similar to the <code>pairs()</code> function we can also apply functions to each of the panels using the <code>panel =</code> argument. For example, let’s add a separate line of best fit from a linear model to each of the panels. Don’t worry about the complicated looking code for now, this example is just included to give you an idea about some of the useful things you can do with base R plotting functions. We will introduce linear models in <a href="simple-lm.html#simple_lm">Chapter 6</a> and cover how to write functions in <a href="prog-r.html#prog_r">Chapter 7</a>.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw">coplot</span>(flowers <span class="op">~</span><span class="st"> </span>weight<span class="op">|</span>nitrogen <span class="op">*</span><span class="st"> </span>treat, <span class="dt">data =</span> flowers,</a>
<a class="sourceLine" id="cb209-2" data-line-number="2">        <span class="dt">panel =</span> <span class="cf">function</span>(x, y, ...) {</a>
<a class="sourceLine" id="cb209-3" data-line-number="3">        <span class="kw">points</span>(x, y, ...)</a>
<a class="sourceLine" id="cb209-4" data-line-number="4">        <span class="kw">abline</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)})</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot30-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="lattice-plots" class="section level3">
<h3><span class="header-section-number">4.2.7</span> Lattice plots</h3>
<p>Many of the plots we’ve previously created using base R graphics can also be created using functions from the <code>lattice</code> package. For example, we can recreate the frequency histogram of the <code>height</code> variable in our <code>flowers</code> data frame using the <code>histogram()</code> function. All of the plotting functions in the lattice package take the formula notation which is why we need to include <code>~ height</code> as our first argument. We also need to specify that we want a frequency histogram by using the argument <code>type = &quot;count&quot;</code>. Don’t forget to first make the package available using <code>library(lattice)</code>.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1"><span class="kw">library</span>(lattice)</a>
<a class="sourceLine" id="cb210-2" data-line-number="2"><span class="kw">histogram</span>(<span class="op">~</span><span class="st"> </span>height, <span class="dt">type =</span> <span class="st">&quot;count&quot;</span>, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot31-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Or perhaps we would like a boxplot of our <code>weight</code> variable for each level of <code>nitrogen</code> using the <code>bwplot()</code> function.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="kw">bwplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot32-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>A (non-exhaustive) list of lattice functions and their base R equivalents is given in the table below.</p>
<p> </p>
<table>
<thead>
<tr class="header">
<th align="left">Graph type</th>
<th align="left">lattice function</th>
<th align="left">Base R function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">scatterplot</td>
<td align="left"><code>xyplot()</code></td>
<td align="left"><code>plot()</code></td>
</tr>
<tr class="even">
<td align="left">frequency histogram</td>
<td align="left"><code>histogram(type = &quot;count&quot;)</code></td>
<td align="left"><code>hist()</code></td>
</tr>
<tr class="odd">
<td align="left">boxplot</td>
<td align="left"><code>bwplot()</code></td>
<td align="left"><code>boxplot()</code></td>
</tr>
<tr class="even">
<td align="left">Cleveland dotplot</td>
<td align="left"><code>dotplot()</code></td>
<td align="left"><code>dotchart()</code></td>
</tr>
<tr class="odd">
<td align="left">scatterplot matrix</td>
<td align="left"><code>splom()</code></td>
<td align="left"><code>pairs()</code></td>
</tr>
<tr class="even">
<td align="left">conditioning plot</td>
<td align="left"><code>xyplot(y ~ x | z)</code></td>
<td align="left"><code>coplot()</code></td>
</tr>
</tbody>
</table>
<p> </p>
<p>Where lattice plots really come into their own is when we want to plot graphs in multiple panels. For example, let’s plot a histogram of our <code>height</code> variable again but this time create a separate histogram for each <code>nitrogen</code> level. We do this by including the <code>|</code> (pipe) symbol which we read as <em>‘height conditional on nitrogen level’</em>. Also notice that the the axis scales are the same for each of the panels to aid comparison which is the default for lattice plots.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="kw">histogram</span>(<span class="op">~</span><span class="st"> </span>height <span class="op">|</span><span class="st"> </span>nitrogen, <span class="dt">type =</span> <span class="st">&quot;count&quot;</span>, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot33-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If we want to change the layout of our plots we can use the <code>layout =</code> argument. Perhaps we prefer all of the graphs to be stacked one on top of the other in which case we would use <code>layout = c(1, 3)</code> to specify 1 column and 3 rows of plots.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="kw">histogram</span>(<span class="op">~</span><span class="st"> </span>height <span class="op">|</span><span class="st"> </span>nitrogen, <span class="dt">type =</span> <span class="st">&quot;count&quot;</span>, </a>
<a class="sourceLine" id="cb213-2" data-line-number="2">           <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot34-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also easily create conditional boxplots using the same logic.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="kw">bwplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen <span class="op">|</span><span class="st"> </span>block, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot35-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Notice in the plot above that the block names don’t seem to be displayed (actually they are, the’re just represented as orange vertical bars in the panel name). The reason for this is that our <code>block</code> variable is an integer variable (you can check this with <code>class(flowers$block)</code>) as the blocks were coded as either a 1 or a 2 in the original dataset that we imported into R. We can change this by creating a new variable in our data frame and use the <code>factor()</code> function to convert <code>block</code> to a factor (<code>flowers$Fblock &lt;- factor(flowers$block)</code>) and then use the <code>Fblock</code> variable as the conditioning variable. Or we can just change <code>block</code> to be a factor <em>‘on-the-fly’</em> when we use it in the <code>bwplot()</code> function. Note, this doesn’t change the <code>block</code> variable in the <code>flowers</code> data frame, just temporarily when we use the <code>bwplot()</code> function.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="kw">bwplot</span>(weight <span class="op">~</span><span class="st"> </span>nitrogen <span class="op">|</span><span class="st"> </span><span class="kw">factor</span>(block), <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot36-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also include more than one conditioning variable. For example, let’s create a scatter plot of <code>height</code> against <code>weight</code> for each level of <code>nitrogen</code> and <code>treat</code>. To do this we’ll use the lattice <code>xyplot()</code> function.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">xyplot</span>(height <span class="op">~</span><span class="st"> </span>weight <span class="op">|</span><span class="st"> </span>nitrogen <span class="op">*</span><span class="st"> </span>treat, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot37-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If we want to highlight which data points come from <code>block 1</code> and which from <code>block 2</code> by automatically changing the plotting symbols we can use the <code>groups =</code> argument. We’ll also include the argument <code>auto.key = TRUE</code> to automatically generate a legend.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="kw">xyplot</span>(flowers <span class="op">~</span><span class="st"> </span>shootarea <span class="op">|</span><span class="st"> </span>nitrogen <span class="op">*</span><span class="st"> </span>treat, </a>
<a class="sourceLine" id="cb217-2" data-line-number="2">        <span class="dt">groups =</span> block, <span class="dt">auto.key =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> flowers)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/plot38-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Hopefully, you’re getting the idea that we can create really informative exploratory plots quite easily using either base R or lattice graphics. Which one you use is entirely up to you (that’s the beauty of using R, you get to choose) and we happily mix and match to suit our needs. In the next section we cover how to customise your base R plots to get them to look exactly how you want.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="baseplot-start.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="custom-plot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/04-base_r_graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rbook.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
